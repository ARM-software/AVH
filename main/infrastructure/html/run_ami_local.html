<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Infrastructure: Run AMI from AWS Console</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="extra_navtree.css" rel="stylesheet" type="text/css"/>
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="printComponentTabs.js"></script>
<script type="text/javascript" src="footer.js"></script>
<script type="text/javascript" src="toc.js"></script>
<script type="text/javascript">
  DoxygenAwesomeInteractiveToc.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="extra_navtree.css" rel="stylesheet" type="text/css"/>
<link href="extra_search.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow" style="height: 55px;">
  <td id="projectlogo" style="padding: 1em;"><img alt="Logo" src="arm.png"/></td>
  <td style="padding-left: 2em; padding-bottom: 1em;padding-top: 1em;">
   <div id="projectname">Arm Virtual Hardware
   &#160;<span id="projectnumber">Version 2.1.0</span>
   </div>
   <div id="projectbrief">AVH FVP Infrastructure</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="Compnav" class="tabs1">
    <ul class="tablist">
      <script type="text/javascript">
		<!--
		writeComponentTabs.call(this);
		//-->
      </script>
	  </ul>
</div>
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('run_ami_local.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Run AMI from AWS Console</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://docs.aws.amazon.com/awsconsolehelpdocs/latest/gsg/learn-whats-new.html">AWS Management Console</a> allows you to control AWS services from a browser window and so provides a simple way to manually setup and use Arm Virtual Hardware AMI.</p>
<p>The key steps in this operation flow are:</p><ul>
<li><a class="el" href="#Launch_ami">Launch AMI Instance</a> .</li>
<li><a class="el" href="#connect_ami">Connect to the AMI Instance</a> .</li>
<li><a class="el" href="#run_example">Run projects</a> using launched AMI instance.</li>
<li>Terminate the AMI instance once it is no longer required.</li>
</ul>
<h1><a class="anchor" id="Launch_ami"></a>
Launch AMI Instance</h1>
<p>An instance of Arm Virtual Hardware AMI can be easily created in AWS Management Console as follows:</p><ul>
<li>Login to the <a href="https://console.aws.amazon.com/">AWS Management Console</a>, search for <b>AWS Marketplace Subscriptions</b> and navigate to the corresponding service.</li>
<li>Find <b>Arm Virtual Hardware</b> already listed in your AWS Marketplace Subscriptions.<ul>
<li>If AVH subsription is not shown, verify that your AWS account is correctly <a class="el" href="AWS.html#Subscribe">subscribed to Arm Virtual Hardware</a>.</li>
</ul>
</li>
<li>Click on <b>Launch new instance</b> for the Arm Virtual Hardware subscription.</li>
<li>Select the initial parameters, especially important is the AWS region. Note that this page gives you access to the <b>Ami Id</b>.</li>
<li>Click on <b>Continue to launch through EC2</b> and proceed to the launch instance wizard.</li>
<li>Configure the instance parameters. Mandatory options are explained below but many other parameters can be also defined here:<ul>
<li><b>Instance Type</b>: select EC2 instance type for running AVH AMI. See <a class="el" href="AWS.html#Requirements">System Requirements</a> for information.</li>
<li><b>Key Pair</b>: select an existing key pair or create a new one. This is required to be able to connect to the AMI instance remotely.</li>
<li><b>Network Settings</b>: verify that VPC Id is specified here. Keep SSH connection enabled.</li>
<li><b>Configure Storage</b>: by default 24 GiB of storage is assoticated with the AMI instance and is sufficient for most applications. However, you can specify the storage parameters here if needed.</li>
<li>Review the parameters and click <b>Launch Instance</b> to create the AVH AMI instance.</li>
<li>You should receive notification that instance was succesfully created.</li>
<li>Navigate to the EC2 service and find newly launched AVH AMI instance listed there and in having "Running" state.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="connect_ami"></a>
Connect to the AMI Instance</h1>
<p>There are multiple ways to connect to the AMI instance that runs Arm Virtual Hardware. For full details refer AWS User Guide <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AccessingInstances.html">Connect to your Linux instance</a>.</p>
<p>In this section two mechanisms are described:</p>
<ul>
<li><a class="el" href="#use_browser">Connect from browser</a> explains the simplest way to access the AMI directly from a browser window.</li>
<li><a class="el" href="#use_ssh">Connect Using SSH</a> allows you to establish remote connection to the AMI using Secure Shell protocol.</li>
</ul>
<h2><a class="anchor" id="use_browser"></a>
Connect from browser</h2>
<p>For simple interaction with the AVH AMI you can run EC2 Instance Connect web-application in your browser directly from the AWS Management Console.</p>
<ul>
<li>Go to <b>EC2 - Instances</b></li>
<li>Select a running AVH AMI instance.</li>
<li>Click <b>Connect</b> (or alternatively use menu <b>Actions - Connect</b>)</li>
<li>Verify that <b>EC2 Instance Connect</b> tab is selected.</li>
<li>Specify <b>ubuntu</b> in the User Name and press <b>Connect</b>.</li>
<li>AMI Linux console opens in a new browser tab.</li>
</ul>
<div class="image">
<img src="ec2_instance_connect.png" alt=""/>
<div class="caption">
Connect to AVH AMI from browser</div></div>
    <h2><a class="anchor" id="use_ssh"></a>
Connect using SSH</h2>
<p>To connect via the Secure Shell (SSH) client of your computer, run the following command in the terminal window:</p>
<div class="fragment"><div class="line">$ ssh  -i &lt;path&gt;/your_key.pem ubuntu@&lt;Public IPv4 DNS&gt;</div>
</div><!-- fragment --><p> <b>Where:</b></p><ul>
<li><b>ssh</b> is the SSH command</li>
<li>option <b>-i</b> specifies the location of the AWS private key file that has the file extension *.pem. Shall correspond to the key pair registered with the AMI instance in <a class="el" href="#Launch_ami">Launch AMI Instance</a>.</li>
<li><b>ubuntu</b> is the user name of the Amazon EC2 Ubuntu Linux instance.</li>
<li><b>&lt;Public IPv4 DNS&gt;</b> is the public address typically in the format: ec2-*nn*-*nn*-*nn*-*nn*.compute-1.amazonaws.com .</li>
</ul>
<p>Note that the <b>ubuntu</b> user by default has no password, because this is not allowed in AWS Marketplace. So initial connection requires authentication via private key file. After logging in, you can enable password authentications as follows:</p><ul>
<li>Enable password login: <div class="fragment"><div class="line">$ sudo sed -i &#39;/PasswordAuthentication no/c\PasswordAuthentication yes&#39; /etc/ssh/sshd_config</div>
<div class="line">$ sudo service ssh restart</div>
</div><!-- fragment --></li>
<li>Set the password value, for example as <em>mypassword</em>: <div class="fragment"><div class="line">$ echo &quot;ubuntu:mypassword&quot; | sudo chpasswd</div>
</div><!-- fragment --></li>
</ul>
<p>Now you can login using password authentication:</p>
<div class="fragment"><div class="line">$ ssh ubuntu@&lt;Public IPv4 DNS&gt;</div>
</div><!-- fragment --><p>and will be requested to enter the password created above (<em>mypassword</em> in this example).</p>
<p>In AWS Management Console you can find the instructions with SSH parameters for a specific AMI instance. Go to <b>EC2 - Instances</b>, select your instance, press <b>Connect</b> and then select the tab <b>SSH client</b>.</p>
<p>Find more details in AWS help <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AccessingInstancesLinux.html">Connect to your Linux instance using SSH</a>.</p>
<h1><a class="anchor" id="run_example"></a>
Run projects</h1>
<p>After <a class="el" href="#connect_ami">connecting to the AVH AMI instance</a> you can copy, compile and run applications on Arm Fixed Virtual Platforms. This section shows how this can be done using the <a href="../../examples/html/MicroSpeech.html">Micro speech example</a>.</p>
<p>Copy the example code to the AMI. Since the project is available on GitHub just execute in the AMI command line:</p>
<div class="fragment"><div class="line">$ git clone https://github.com/arm-software/AVH-TFLmicrospeech.git</div>
</div><!-- fragment --><p>For shared private projects your GitHub Username and Password key will be required to clone.</p>
<p>Navigate to the example directory: </p><div class="fragment"><div class="line">$ cd ./AVH-TFLmicrospeech/Platform_FVP_Corstone_SSE-300_Ethos-U55</div>
</div><!-- fragment --><p> Install the necessary CMSIS Packs (you may need to change permissions for the script): </p><div class="fragment"><div class="line">$ chmod 777 packlist.sh</div>
<div class="line">$ ./packlist.sh</div>
</div><!-- fragment --><p> Note that if this generated errors, you most likely have a legacy set up. Use this command to install packs instead: </p><div class="fragment"><div class="line">$ cp_install.sh packlist</div>
</div><!-- fragment --><p> Build the example: </p><div class="fragment"><div class="line">$ cbuild.sh microspeech.Example.cprj</div>
</div><!-- fragment --><p> When built, you can now run the example on the FVP: </p><div class="fragment"><div class="line">$ ./run_example.sh</div>
</div><!-- fragment --><p> The output should display similar to: </p><div class="fragment"><div class="line">Fast Models [11.15.14 (Jun 23 2021)]</div>
<div class="line">Copyright 2000-2021 ARM Limited.</div>
<div class="line">All Rights Reserved.</div>
<div class="line"> </div>
<div class="line">telnetterminal0: Listening for serial connection on port 5000</div>
<div class="line">telnetterminal1: Listening for serial connection on port 5001</div>
<div class="line">telnetterminal2: Listening for serial connection on port 5002</div>
<div class="line">telnetterminal5: Listening for serial connection on port 5003</div>
<div class="line"> </div>
<div class="line">    Ethos-U rev f19bc8d4 --- Apr 23 2021 13:24:11</div>
<div class="line">    (C) COPYRIGHT 2019-2021 Arm Limited</div>
<div class="line">    ALL RIGHTS RESERVED</div>
<div class="line"> </div>
<div class="line">Heard yes (147) @1000ms</div>
<div class="line">Heard no (141) @5600ms</div>
<div class="line">Heard yes (149) @9100ms</div>
<div class="line">Heard no (142) @13600ms</div>
<div class="line">Heard yes (149) @17100ms</div>
<div class="line"> </div>
<div class="line">Info: Simulation is stopping. Reason: Cycle limit has been exceeded.</div>
<div class="line"> </div>
<div class="line">Info: /OSCI/SystemC: Simulation stopped by user.</div>
<div class="line">[warning ][main@0][01 ns] Simulation stopped by user</div>
<div class="line"> </div>
<div class="line">--- cpu_core statistics: ----------------------------------------------------</div>
<div class="line">Simulated time                          : 20.000002s</div>
<div class="line">User time                               : 396.865593s</div>
<div class="line">System time                             : 1.924400s</div>
<div class="line">Wall time                               : 398.550649s</div>
<div class="line">Performance index                       : 0.05</div>
<div class="line">cpu_core.cpu0                           :  10.03 MIPS (  4000000000 Inst)</div>
<div class="line">----------------------------------------------------------------------------</div>
</div><!-- fragment --> <h1><a class="anchor" id="other"></a>
Other connections</h1>
<h2><a class="anchor" id="code-server"></a>
Enable Code Server (Visual Studio Code)</h2>
<p>The Arm Virtual Hardware AMI comes with <a href="https://github.com/cdr/code-server">Code Server</a>, enabling access to <a href="https://github.com/Microsoft/vscode">Visual Studio Code</a> with a web browser. To access it, you will need to start a SSH tunnel to the instance and forward port <code>8080</code>.</p>
<p>On Linux, MacOS or Windows Powershell: </p><div class="fragment"><div class="line">ssh -i &lt;key.pem&gt; -N -L 8080:localhost:8080 ubuntu@&lt;AMI_IP_addr&gt;</div>
</div><!-- fragment --><p>The <code>-N</code> option holds the SSH tunnel connection and does not allow to execute other remote commands. This is useful when only forwarding ports.</p>
<p>You can then access the IDE via a web browser on your local machine at <a href="http://localhost:8080">http://localhost:8080</a></p>
<h2><a class="anchor" id="vnc"></a>
Enable Virtual Network Computing (VNC)</h2>
<p>VNC is a protocol to enable remote desktop. The instructions below will securely enable VNC through a SSH tunnel.</p>
<p>In the AMI terminal:</p>
<ul>
<li>Enable and set VNC password (You do not need to enter a view-only password when prompted) <div class="fragment"><div class="line">vncpasswd</div>
</div><!-- fragment --></li>
<li>To start the VNC server for the session <div class="fragment"><div class="line">sudo systemctl start vncserver@1.service</div>
</div><!-- fragment --></li>
<li>To restart the VNC server after reboot <div class="fragment"><div class="line">sudo systemctl enable vncserver@1.service</div>
</div><!-- fragment --></li>
</ul>
<p>On your local machine:</p>
<ul>
<li>Forward port <code>5901</code> on local machine. On Linux, MacOS or Windows Powershell: <div class="fragment"><div class="line">ssh -I &lt;key.pem&gt; -N â€“L 5901:localhost:5901 ubuntu@&lt;AMI_IP_addr&gt;</div>
</div><!-- fragment --></li>
</ul>
<p>The <code>-N</code> option holds the SSH tunnel connection and does not allow to execute other remote commands. This is useful when only forwarding ports.</p>
<p>Connect your VNC client (e.g. <a href="https://remmina.org">Remmina</a>, <a href="https://tigervnc.org">TigerVNC</a>) to port <code>5901</code>. You will be prompted for the VNC password. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
	Copyright &copy; 2021-2023 Arm Limited (or its affiliates). All rights reserved.
	<!-- Use script below for auto-inserting date, project name, version, etc  -->
	<!-- <script type="text/javascript">
        writeFooter.call(this);
    </script> -->
    </li>
  </ul>
</div>
</body>
</html>

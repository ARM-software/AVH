<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Infrastructure: Use with Keil µVision</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="extra_navtree.css" rel="stylesheet" type="text/css"/>
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="printComponentTabs.js"></script>
<script type="text/javascript" src="footer.js"></script>
<script type="text/javascript" src="toc.js"></script>
<script type="text/javascript">
  DoxygenAwesomeInteractiveToc.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="extra_navtree.css" rel="stylesheet" type="text/css"/>
<link href="extra_search.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow" style="height: 55px;">
  <td id="projectlogo" style="padding: 1em;"><img alt="Logo" src="arm.png"/></td>
  <td style="padding-left: 2em; padding-bottom: 1em;padding-top: 1em;">
   <div id="projectname">Arm Virtual Hardware
   &#160;<span id="projectnumber">Version 2.0.0</span>
   </div>
   <div id="projectbrief">AVH FVP Infrastructure</div>
  </td>
  <!--END !PROJECT_NAME-->
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="Compnav" class="tabs1">
    <ul class="tablist">
      <script type="text/javascript">
		<!--
		writeComponentTabs.call(this);
		//-->
      </script>
	  </ul>
</div>
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('run_mdk_uv4.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Use with Keil µVision </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_src_avh_mdk_uv4"></a> This section explains how Arm Fixed Virtual Platforms (FVP) can be used with <a href="https://developer.arm.com/tools-and-software/embedded/keil-mdk">Keil µVision</a> tools for developing and debugging embedded applications on a local computer.</p>
<h1><a class="anchor" id="mdk_fvp_install"></a>
Tools Installation</h1>
<ul>
<li><a href="https://developer.arm.com/documentation/101407/latest/About-uVision/Installation">Download and Install Keil MDK µVision</a> v5.40 on your Windows PC, if not present yet.</li>
<li>Ensure that a user-based license is activated either for the <a href="https://www.keil.arm.com/mdk-community">MDK-Community</a> (evaluation and non-commercial use) or <a href="https://www.keil.arm.com/keil-mdk/#mdk-v6-editions">MDK-Professional</a> (commercial use) editions. This is required for running AVH FVP models.</li>
<li>[<em>Optional</em>] Enable Telnet Client on Windows 10. This will allow to observe UART output from the AVH device during debug.<ul>
<li>Open <em>Start</em> &gt; <em>Settings</em>.</li>
<li>In the search box, type <em>Turn Windows features on or off</em> and click on the suggested item. The <em>Windows Features</em> dialog opens.</li>
<li>Select the <em>Telnet Client</em> check box and click <em>OK</em>. The installation might take several minutes to complete.</li>
</ul>
<img src="windows_telnet_enable.png" alt="" class="inline" title="Enable Windows Telnet Client"/>    </li>
</ul>
<h1><a class="anchor" id="mdk_uv4_project_config"></a>
Project Configuration</h1>
<p>Two important configuration areas need special attention in µVision projects for Arm FVPs:</p><ul>
<li><a class="el" href="run_mdk_uv4.html#mdk_uv4_fvp_targets">Target selection</a> in the project. This is required for new projects or when changing the target device in an existing project.</li>
<li><a class="el" href="run_mdk_uv4.html#mdk_uv4_fvp_debug">Run and debug configuration</a> in the project. This step is typically needed for setting up any project, but with reference AVH examples brief verification of the default settings can be sufficient.</li>
</ul>
<h2><a class="anchor" id="mdk_uv4_fvp_targets"></a>
Target selection</h2>
<p>Device support for AVH FVP targets is implemented with the same CMSIS principles as used for real hardware devices. <a href="../../simulation/html/avh_fvp_cmsis.html">CMSIS-based projects for AVH FVPs</a> lists the device family packs and BSP packs required for use with AVH FVPs.</p>
<p>When opening an existing project you will be asked if any missing packs required by the project shall be installed. If you agree to that, also the necessary pack with device definition for the target device used in the project will be automatically installed.</p>
<p>When creating a new project or when changing the target in an existing project you need to select an FVP target as follows:</p><ul>
<li>Install the CMSIS pack with target device definition, if not present yet:<ul>
<li>Start <a href="https://developer.arm.com/documentation/101407/latest/Creating-Applications/Software-Components/Pack-Installer"><em>Pack Installer</em></a> utility.</li>
<li>In <em>Devices</em> tab expand <em>ARM</em> section and select the target Cortex-M core.</li>
<li>In the <a href="https://developer.arm.com/documentation/101407/latest/Creating-Applications/Software-Components/Pack-Installer/Packs-Dialog"><em>Packs</em> tab</a> under <em>Device Specific</em> category select the target CMSIS pack that implements the required device according to the table in <a href="../../simulation/html/avh_fvp_cmsis.html">CMSIS-based projects for AVH FVPs</a>.</li>
<li>Press <em>Install</em> or <em>Update</em> button in the Action field to get the latest version installed. For example for Arm Cortex-M4:<br  />
 <img src="mdk_avh_device_pack.png" alt="" class="inline" title="Install device pack for AVH FVP"/>    </li>
<li>Observe the button status changed to <em>Up to date</em> and return to the project in µVision.</li>
</ul>
</li>
<li>Select AVH device as the target in your project:<ul>
<li>In the project open <em>Options for target...</em> dialog and select <em>Device</em> tab.</li>
<li>In the list of device vendors expand <em>ARM</em> group.</li>
<li>Expand the group of your target Cortex-M core.</li>
<li>In the list select the target device according to the table in <a href="../../simulation/html/avh_fvp_cmsis.html">CMSIS-based projects for AVH FVPs</a> and press <em>OK</em>.<br  />
 For example for Arm Cortex-M4:<br  />
 <img src="mdk_avh_device_select.png" alt="" class="inline" title="Select AVH FVP device as the target"/>    </li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="mdk_uv4_fvp_debug"></a>
Run and debug configuration</h2>
<p>Configure execution and debug of an µVision project on an AVH FVP model using the steps explained in the <a href="https://developer.arm.com/documentation/101407/latest/Simulation/AVH-FVP-Targets/Debug-Driver-Configuration">Debug Driver Coviguration</a> for AVH FVP targets.</p>
<ul>
<li>In the <em>Debug</em> tab, in the <em>Initilization File</em> field, use the ... button to provide a path to a file that assigns <code>CORE_CLK</code> to the same value as specified for the <code>core_clk.mul</code> parameter in the model configuration file. This ensures that the timing for µVision displays is correctly calculated in synch with the simulation. <em>Edit</em> button can be used to view and modify the file in the µVision editor. Figure below shows the example configuration and content of the files used, <em>mdk_fvp_config.txt</em> and <em>mdk_fvp_init.ini</em>:<br  />
 <img src="mdk_fvp_core_clk.png" alt="" class="inline" title="MDK Core Clock configuration"/>    </li>
</ul>
<h1><a class="anchor" id="mdk_uv4_program_run"></a>
Program Build and Debug</h1>
<p>Project build and debug on an AVH FVP target can be done in the similar way as any other Keil µVision project:</p>
<ul>
<li>Press <em>Rebuild</em> button in µVision toolbar (or use <code>F7</code> hotkey).</li>
<li>Start the debug session from µVision toolbar (or with <code>Ctrl-F5</code>). The model executable window should pop up (with <code>C:\WINDOWS\system32\cmd.exe</code>) but it will stay empty during the session. Also see []()</li>
<li>If enabled in <a class="el" href="run_mdk_uv4.html#mdk_uv4_fvp_debug">Run and debug configuration</a>, a Telnet client will start. Program output should be expected there.</li>
<li>Debug the project as usual with available µVision functionality. Refer to <a href="https://developer.arm.com/documentation/101407/0540/Simulation/AVH-FVP-Targets/Application-Debug">Application Debug on AVH FVPs</a> for additional details and references.</li>
</ul>
<h1><a class="anchor" id="mdk_uv4_csolution"></a>
Using csolution projects</h1>
<p>Projects in universal <a href="https://github.com/Open-CMSIS-Pack/cmsis-toolbox/blob/main/docs/YML-Input-Format.md">csolution format</a> can be open in Keil MDK µVision for debugging. See notes about "Open Project..." item in the <a href="https://developer.arm.com/documentation/101407/0540/User-Interface/Project-Menu-and-Commands">Project Menu and Commands</a>.</p>
<p>You can also export the µVision project go to the csolution format by choosing menu <a href="https://developer.arm.com/documentation/101407/latest/User-Interface/Project-Menu-and-Commands/Export-Menu"><em>Project</em> - <em>Export</em></a> and select <em>Save project to csolution format</em>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
	Copyright &copy; 2021-2023 Arm Limited (or its affiliates). All rights reserved.
	<!-- Use script below for auto-inserting date, project name, version, etc  -->
	<!-- <script type="text/javascript">
        writeFooter.call(this);
    </script> -->
    </li>
  </ul>
</div>
</body>
</html>
